# Writeup sharing is caring

## by Lily

You are given a `bittorrent` file and a url that leads you to `s0lomon's gate` web page. on the page, you can find 4 different `login modal inputs`. you can try submitting arbitrary credentials, though you won't get pass the auth page. Now, let's check the given torrent file (you can analyze the file metadata first, or you can try leeching using bittorrent client e.g `bittorent`, `utorrent` ,etc). if we try to leech the torrent using bittorrent client, it won't download anything, nor it connects to any peers. hmm, this is weird. if we analyze the trackers list (again, you can either use the client or any tool), the tracker list seems empty. even if you force-use DHT peering, it still doesn't connect to any peers. it seems we have to analyze the torrent even deeper, and `torrent-parser` would come in handy.


after we parse the torrent, we can see clearly the contents of the torrent file. Now, there are things you have to know regarding torrent. torrent divides file into pieces/chunks of data in which the `piece-length` is equal throughout the entirety, except for the lastpiece (you can read regarding this matter further on google) and torrent stores the `sha1-hashed-pieces` value on the `torrent` so that it can check the validity and integrity of the `entire-file`. 

now, on the parsed-torrent we can see that the `announce-lists` and `trackers` are set to incorrect url or tracker, this explains why we can't connect to any peers. even further we can see the `data-length` and the `piece-length` and the `hashed-pieces` info. Now you know the `piece-length` is 12 bytes. recall that an ascii char/code is represented by 8 bit, or 1 byte. This means bruteforcing sha1 would be absurd, since there are 127^12 possibility.  But since the challenge description mentions "full-width japanese" keyboard, it means the text is supposedly to be encoded as unicode. Now each japanese full-width char takes 3 bytes, thus every piece of torrent only consists of 12/3 == 4 full-width chars, making this feasible for bruteforcing (only takes around 20 - 30 minutes on single thread). 
